# frozen_string_literal: true

class ScanUrlsController < ApplicationController
  require 'httparty'
  require 'pry'

  def index
    @vulnerabilities = Vulnerability.all
    Analysis.new
    @id = Analysis.last()
    # binding.pry
  end

  def analize
    url = params[:url]
    vulnerabilities = params[:vulnerabilities]
    result = HTTParty.post('http://127.0.0.1:5000/scanner/start'.to_str,
                           body: {
                            idScann: 2,
                            url: url,
                            vulnerabilities: vulnerabilities
                           }.to_json,
                           headers: { 'Content-Type' => 'application/json' })
    logger.info(result)
     redirect_to 'http://127.0.0.1:3000/'
  end
end
