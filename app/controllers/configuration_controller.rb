class ConfigurationController < ApplicationController

  def show
  end

  def edit
    @user = User.find(params[:id])
  end

  def update
    @user = User.find(params[:id])

    post_params = params.require(:user).permit(:email, :encrypted_password)

    @user.update(email: params[:email])
  end


  def destroy

    @user = User.find(params[:id])

    @analyses = Analysis.where("user_id = #{@user.id}")

    @analyses.each do |analysis|
      @analysisTestsVulnerabilities = AnalysisTestsVulnerability.where("analyses_id = #{analysis.id}")
      if @analysisTestsVulnerabilities[0]
        @analysisTestsVulnerabilities.destroy
      end
      @flaw = SecurityFlaw.where("analyses_id = #{analysis.id}")
      if @flaw[0]
        @flaw.destroy
      end
      analysis.destroy
    end

    @user.destroy

    redirect_to home_path

  end

end
